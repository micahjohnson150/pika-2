/****************************************************************/
/*       PIKA - Phase field snow micro-structure model          */
/*                                                              */
/*          Prepared by Battelle Energy Alliance, LLC           */
/*            Under Contract No. DE-AC07-05ID14517              */
/*            With the U. S. Department of Energy               */
/*                                                              */
/*            See COPYRIGHT for full restrictions               */
/****************************************************************/


// Pika includes
#include "AirProperties.h"

template<>
InputParameters validParams<AirProperties>()
{
  InputParameters params = validParams<Material>();
  params += validParams<PropertyUserObjectInterface>();
  params += AirProperties::objectParams();
  params.addCoupledVar("temperature", 273.15, "The temperature variable to couple (default: 273.15 K)");
  return params;
}

AirProperties::AirProperties(const std::string & name, InputParameters parameters) :
    Material(name, parameters),
    PropertyUserObjectInterface(name, parameters),
    _temperature(coupledValue("temperature")),
    _k_a_input(getParam<Real>("conductivity_air")),
    _c_a_input(getParam<Real>("heat_capacity_air")),
    _D_v_input(getParam<Real>("water_vapor_diffusion_coefficient")),
    _rho_a(declareProperty<Real>("density_air")),
    _k_a(declareProperty<Real>("conductivity_air")),
    _c_a(declareProperty<Real>("heat_capacity_air")),
    _D_v(declareProperty<Real>("water_vapor_diffusion_coefficient"))
{
}

void
AirProperties::computeQpProperties()
{
  _rho_a[_qp] = _property_uo.airDensity(_temperature[_qp]);

  _k_a[_qp] = _k_a_input;

  _c_a[_qp] = _c_a_input;

  _D_v[_qp] = _D_v_input;
}

InputParameters
AirProperties::objectParams()
{
  InputParameters params = emptyInputParameters();
  params.addParam<Real>("conductivity_air", 0.02, "Thermal conductivity or air, kappa_a [ W/(m K)]");
  params.addParam<Real>("heat_capacity_air", 1.4e3, "Heat capacity of air, C_a [J/(m^3 K)]");
  params.addParam<Real>("water_vapor_diffusion_coefficient", 2.178e-5, "Diffusion coefficient water vapor in air, D_v [m^2/s]");
  return params;
}
